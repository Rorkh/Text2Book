# Testing
To demonstrate that Text2Book is compatible with Minecraft books, ensuring that the text generated by the app can 
seamlessly fit within a Minecraft book, we need to access an in-game book containing the generated text. If the contents
of the book match those of the app output, we can confirm that the app works correctly. To achieve this, we compare the 
text on a page-by-page basis.

The app divides and generates an array of lines, which is then further divided by 14 
(the maximum number of lines that can fit on a book page) to create the contents of each page. This is essential because 
the `@give` command in Minecraft includes an argument called `pages`, which expects an array containing the text content 
for each page of the book. Therefore, if any page in the Minecraft book does not match the corresponding page of the 
app output, we can conclude that something is not working as expected.

## Methodology
The contents of a players inventory can be accessed through a `.dat` file located within the `playerdata` folder in a 
Minecraft world save. This `.dat` file is formatted with the [nbt format](https://minecraft.fandom.com/wiki/NBT_format) exlusively used in Minecraft, but it's 
possible to parse using the [nbt npm package](https://www.npmjs.com/package/nbt). A players inventory is stored within [`TAG_List('Inventory')`](https://wiki.vg/NBT#level.dat), 
in which any Minecraft books present will have the id value `minecraft:written_book`.  Conveniently, within the tag 
value of a Minecraft book there is another tag called `pages` which is where we find the contents of the in-game book.

To facilitate comparison of the contents retrieved from the game, we generate a JSON file containing a list of pages 
generated by the application. This JSON file is created by navigating to the `/debug` URL path, entering text, and 
clicking "Generate". The generated JSON file serves as an input parameter, as described in the following section.

## Running tests
Testing sadly isn't as convenient as running a script. There are some steps we need to take before continuing:

1. Open Minecraft.
2. Create or open a world.
3. Open [Text2Book](https://thewilley.github.io/Text2Book/) and check the "Generate Commands" option. 
4. Fill the form while keeping the following in mind:
   1. **Title must be "text2book"**.
   2. Author can be anything.
   3. Text can be anything.
5. Click "Generate" and copy command.
6. Run the command in a command block to generate the book. Make sure it's in an inventory slot.
7. Save and exit the world.
8. Open the [debug page on Text2Book](https://thewilley.github.io/Text2Book/debug).
9. Paste the same text you used in step 3.
10. Press "Generate" to download a JSON file containing pages.

At this point, we are finally ready to start out tests. This is done using `npm run test`, which takes two parameters: 
* `mcworld` - The filepath to the Minecraft world where we have our generated book.
* `input` - The JSON file created by Text2Book

For example:
```batch
$ npm run test -- --mcworld '/home/thewilley/.minecraft/saves/myworld/' --input '/home/thewilley/Downloads/text2book.json'
```

After this we will either get a success message, or a list of pages where the Minecraft book did not match with the 
app output.